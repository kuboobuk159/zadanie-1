<!DOCTYPE html>
<html lang="sk">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hrať Snake - Moderná Klasika</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                    },
                    colors: {
                        snake: {
                            light: '#34d399',
                            DEFAULT: '#10b981',
                            dark: '#059669',
                        }
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Outfit', sans-serif;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }

        .bg-gradient-mesh {
            background-color: #f0f9ff;
            background-image:
                radial-gradient(at 40% 20%, hsla(158, 100%, 90%, 1) 0px, transparent 50%),
                radial-gradient(at 80% 0%, hsla(189, 100%, 90%, 1) 0px, transparent 50%),
                radial-gradient(at 0% 50%, hsla(158, 100%, 93%, 1) 0px, transparent 50%),
                radial-gradient(at 80% 50%, hsla(189, 100%, 93%, 1) 0px, transparent 50%),
                radial-gradient(at 0% 100%, hsla(158, 100%, 93%, 1) 0px, transparent 50%),
                radial-gradient(at 80% 100%, hsla(189, 100%, 93%, 1) 0px, transparent 50%),
                radial-gradient(at 0% 0%, hsla(158, 100%, 93%, 1) 0px, transparent 50%);
        }

        canvas {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
    </style>
</head>

<body class="bg-gradient-mesh min-h-screen flex flex-col items-center justify-center p-4 overflow-hidden select-none">

    <!-- Header / Score Board -->
    <div class="w-full max-w-2xl flex justify-between items-center mb-6 glass-panel px-6 py-4 rounded-2xl z-10">
        <a href="index.html"
            class="flex items-center gap-2 text-slate-600 hover:text-emerald-600 transition-colors font-medium">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd"
                    d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z"
                    clip-rule="evenodd" />
            </svg>
            Späť
        </a>
        <div class="flex items-center gap-6">
            <div class="text-center">
                <p class="text-xs text-slate-500 uppercase tracking-wider font-bold">Skóre</p>
                <p id="score" class="text-2xl font-bold text-emerald-600 leading-none">0</p>
            </div>
            <div class="text-center">
                <p class="text-xs text-slate-500 uppercase tracking-wider font-bold">Najlepšie</p>
                <p id="high-score" class="text-2xl font-bold text-slate-700 leading-none">0</p>
            </div>
        </div>
    </div>

    <!-- Game Container -->
    <div class="relative group">
        <canvas id="gameCanvas" width="600" height="600"
            class="bg-white/80 rounded-xl border-4 border-white cursor-crosshair max-w-full max-h-[70vh] aspect-square"></canvas>

        <!-- Start / Game Over Overlay -->
        <div id="overlay"
            class="absolute inset-0 bg-white/40 backdrop-blur-sm rounded-lg flex flex-col items-center justify-center z-20 transition-opacity duration-300">
            <div class="glass-panel p-8 rounded-2xl text-center shadow-2xl transform transition-all hover:scale-105">
                <h2 id="overlay-title" class="text-4xl font-bold text-slate-800 mb-2">Pripravený?</h2>
                <p id="overlay-subtitle" class="text-slate-600 mb-8">Použi šípky na ovládanie</p>
                <button id="start-btn"
                    class="px-8 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white font-bold rounded-full shadow-lg hover:shadow-emerald-500/40 transition-all hover:-translate-y-1 active:translate-y-0">
                    Spustiť Hru
                </button>
            </div>
        </div>
    </div>

    <!-- Mobile Controls (Visible only on small screens) -->
    <div class="mt-8 grid grid-cols-3 gap-2 md:hidden">
        <div></div>
        <button id="btn-up"
            class="w-16 h-16 glass-panel rounded-full flex items-center justify-center active:bg-emerald-100 text-slate-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18" />
            </svg>
        </button>
        <div></div>
        <button id="btn-left"
            class="w-16 h-16 glass-panel rounded-full flex items-center justify-center active:bg-emerald-100 text-slate-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
            </svg>
        </button>
        <button id="btn-down"
            class="w-16 h-16 glass-panel rounded-full flex items-center justify-center active:bg-emerald-100 text-slate-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3" />
            </svg>
        </button>
        <button id="btn-right"
            class="w-16 h-16 glass-panel rounded-full flex items-center justify-center active:bg-emerald-100 text-slate-700">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
            </svg>
        </button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const highScoreElement = document.getElementById('high-score');
        const overlay = document.getElementById('overlay');
        const overlayTitle = document.getElementById('overlay-title');
        const overlaySubtitle = document.getElementById('overlay-subtitle');
        const startBtn = document.getElementById('start-btn');

        // Game Settings
        const GRID_SIZE = 20;
        let TILE_COUNT = canvas.width / GRID_SIZE;

        // Responsive Canvas
        function resizeCanvas() {
            const size = Math.min(window.innerWidth - 32, 600);
            // Ensure size is a multiple of GRID_SIZE
            const adjustedSize = Math.floor(size / GRID_SIZE) * GRID_SIZE;
            canvas.width = adjustedSize;
            canvas.height = adjustedSize;
            TILE_COUNT = canvas.width / GRID_SIZE;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // Game State
        let score = 0;
        let highScore = localStorage.getItem('snakeHighScore') || 0;
        highScoreElement.innerText = highScore;

        let velocityX = 0;
        let velocityY = 0;
        let snake = [];
        let food = { x: 5, y: 5 };
        let gameInterval;
        let isGameRunning = false;
        let speed = 100; // ms

        // Audio Context (Simple Beeps)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            if (type === 'eat') {
                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(600, audioCtx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(1000, audioCtx.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.1);
            } else if (type === 'die') {
                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(200, audioCtx.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.3);
                gainNode.gain.setValueAtTime(0.2, audioCtx.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                oscillator.start();
                oscillator.stop(audioCtx.currentTime + 0.3);
            }
        }

        function initGame() {
            snake = [{ x: 10, y: 10 }];
            score = 0;
            scoreElement.innerText = score;
            velocityX = 1;
            velocityY = 0;
            placeFood();
            isGameRunning = true;
            overlay.classList.add('opacity-0', 'pointer-events-none');
            if (gameInterval) clearInterval(gameInterval);
            gameInterval = setInterval(gameLoop, speed);
        }

        function placeFood() {
            food.x = Math.floor(Math.random() * TILE_COUNT);
            food.y = Math.floor(Math.random() * TILE_COUNT);
            // Check if food spawned on snake
            for (let part of snake) {
                if (part.x === food.x && part.y === food.y) {
                    placeFood();
                    break;
                }
            }
        }

        function gameLoop() {
            update();
            draw();
        }

        function update() {
            // Move Snake
            const head = { x: snake[0].x + velocityX, y: snake[0].y + velocityY };

            // Wall Collision (Wrap around or Die? Let's Die for classic feel)
            if (head.x < 0 || head.x >= TILE_COUNT || head.y < 0 || head.y >= TILE_COUNT) {
                gameOver();
                return;
            }

            // Self Collision
            for (let part of snake) {
                if (head.x === part.x && head.y === part.y) {
                    gameOver();
                    return;
                }
            }

            snake.unshift(head);

            // Eat Food
            if (head.x === food.x && head.y === food.y) {
                score += 10;
                scoreElement.innerText = score;
                if (score > highScore) {
                    highScore = score;
                    highScoreElement.innerText = highScore;
                    localStorage.setItem('snakeHighScore', highScore);
                }
                playSound('eat');
                placeFood();
                // Speed up slightly
                if (speed > 50) speed -= 1;
                clearInterval(gameInterval);
                gameInterval = setInterval(gameLoop, speed);
            } else {
                snake.pop();
            }
        }

        function draw() {
            // Clear Canvas
            ctx.fillStyle = '#f8fafc'; // Slate-50
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw Grid (Optional, subtle)
            ctx.strokeStyle = '#e2e8f0';
            ctx.lineWidth = 0.5;
            for (let i = 0; i <= TILE_COUNT; i++) {
                ctx.beginPath();
                ctx.moveTo(i * GRID_SIZE, 0);
                ctx.lineTo(i * GRID_SIZE, canvas.height);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(0, i * GRID_SIZE);
                ctx.lineTo(canvas.width, i * GRID_SIZE);
                ctx.stroke();
            }

            // Draw Food
            ctx.fillStyle = '#f43f5e'; // Rose-500
            ctx.beginPath();
            const foodX = food.x * GRID_SIZE + GRID_SIZE / 2;
            const foodY = food.y * GRID_SIZE + GRID_SIZE / 2;
            ctx.arc(foodX, foodY, GRID_SIZE / 2 - 2, 0, Math.PI * 2);
            ctx.fill();
            // Shine on apple
            ctx.fillStyle = 'rgba(255,255,255,0.6)';
            ctx.beginPath();
            ctx.arc(foodX - 2, foodY - 2, 3, 0, Math.PI * 2);
            ctx.fill();

            // Draw Snake
            snake.forEach((part, index) => {
                // Gradient effect for snake
                if (index === 0) {
                    ctx.fillStyle = '#059669'; // Darker head
                } else {
                    ctx.fillStyle = '#10b981'; // Emerald-500 body
                }

                // Rounded rectangles for body parts
                const x = part.x * GRID_SIZE;
                const y = part.y * GRID_SIZE;
                const size = GRID_SIZE - 2;
                const radius = 4;

                ctx.beginPath();
                ctx.roundRect(x + 1, y + 1, size, size, radius);
                ctx.fill();

                // Eyes for head
                if (index === 0) {
                    ctx.fillStyle = 'white';
                    // Determine eye position based on direction
                    let eyeOffsetX = 0, eyeOffsetY = 0; // Simplified for now

                    ctx.beginPath();
                    ctx.arc(x + 6, y + 6, 2, 0, Math.PI * 2);
                    ctx.arc(x + 14, y + 6, 2, 0, Math.PI * 2);
                    ctx.fill();
                }
            });
        }

        function gameOver() {
            isGameRunning = false;
            clearInterval(gameInterval);
            playSound('die');

            overlayTitle.innerText = "Koniec Hry!";
            overlaySubtitle.innerText = `Dosiahol si skóre: ${score}`;
            startBtn.innerText = "Hrať Znova";
            overlay.classList.remove('opacity-0', 'pointer-events-none');
        }

        // Controls
        function changeDirection(x, y) {
            if (!isGameRunning) return;
            // Prevent 180 degree turns
            if (velocityX !== 0 && x === -velocityX) return;
            if (velocityY !== 0 && y === -velocityY) return;

            velocityX = x;
            velocityY = y;
        }

        document.addEventListener('keydown', (e) => {
            switch (e.key) {
                case 'ArrowUp': case 'w': case 'W': changeDirection(0, -1); break;
                case 'ArrowDown': case 's': case 'S': changeDirection(0, 1); break;
                case 'ArrowLeft': case 'a': case 'A': changeDirection(-1, 0); break;
                case 'ArrowRight': case 'd': case 'D': changeDirection(1, 0); break;
            }
        });

        // Touch Controls
        document.getElementById('btn-up').addEventListener('click', () => changeDirection(0, -1));
        document.getElementById('btn-down').addEventListener('click', () => changeDirection(0, 1));
        document.getElementById('btn-left').addEventListener('click', () => changeDirection(-1, 0));
        document.getElementById('btn-right').addEventListener('click', () => changeDirection(1, 0));

        startBtn.addEventListener('click', initGame);

    </script>
</body>

</html>